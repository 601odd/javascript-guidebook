<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/javascript-guidebook/umi.3ddb0a84.css" />
    <script>
      window.routerBase = "/javascript-guidebook/";
    </script>
    <script>
      //! umi version: 3.2.16
    </script>
    <title>HTTP 身份校验</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/javascript-guidebook-favicon.png&#x27;)" href="/javascript-guidebook//">JavaScript Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="/javascript-guidebook//basic-concept">基本语法</a><a href="/javascript-guidebook//standard-built-in-objects">内置对象</a><a href="/javascript-guidebook//core-modules">核心模块</a><a href="/javascript-guidebook//object-oriented-programming">OOP</a><a href="/javascript-guidebook//browser-object-model">BOM</a><a href="/javascript-guidebook//document-object-model">DOM</a><a aria-current="page" class="active" href="/javascript-guidebook//computer-networks">计算机网络</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/javascript-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/javascript-guidebook-favicon.png&#x27;)" href="/javascript-guidebook//"></a><h1>JavaScript Guidebook</h1><p>JavaScript 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/javascript-guidebook//basic-concept">基本语法</a></li><li><a href="/javascript-guidebook//standard-built-in-objects">内置对象</a></li><li><a href="/javascript-guidebook//core-modules">核心模块</a></li><li><a href="/javascript-guidebook//object-oriented-programming">OOP</a></li><li><a href="/javascript-guidebook//browser-object-model">BOM</a></li><li><a href="/javascript-guidebook//document-object-model">DOM</a></li><li><a aria-current="page" class="active" href="/javascript-guidebook//computer-networks">计算机网络</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/javascript-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/javascript-guidebook//computer-networks">计算机网络</a></li><li><a href="/javascript-guidebook//computer-networks/computer-network-architecture">计算机网络体系</a><ul><li><a href="/javascript-guidebook//computer-networks/computer-network-architecture/computer-networks"><span>计算机网络体系</span></a></li><li><a href="/javascript-guidebook//computer-networks/computer-network-architecture/transport-layer-protocol"><span>传输层协议</span></a></li><li><a href="/javascript-guidebook//computer-networks/computer-network-architecture/network-layer-protocol"><span>网络层协议</span></a></li><li><a href="/javascript-guidebook//computer-networks/computer-network-architecture/dns"><span>DNS 域名解析系统</span></a></li><li><a href="/javascript-guidebook//computer-networks/computer-network-architecture/cdn"><span>CDN 内容分发网络</span></a></li></ul></li><li><a aria-current="page" class="active" href="/javascript-guidebook//computer-networks/http">HTTP</a><ul><li><a href="/javascript-guidebook//computer-networks/http/http"><span>HTTP</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/https"><span>HTTPS</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/headers"><span>HTTP 首部字段</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/request-methods"><span>HTTP 请求方法</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/status-code"><span>HTTP 状态码</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/access-control"><span>HTTP 跨域资源共享</span></a></li><li><a aria-current="page" class="active" href="/javascript-guidebook//computer-networks/http/authentication"><span>HTTP 身份校验</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/http2"><span>HTTP2</span></a></li><li><a href="/javascript-guidebook//computer-networks/http/http3"><span>HTTP3</span></a></li></ul></li><li><a href="/javascript-guidebook//computer-networks/frontend-security">Web 安全</a><ul><li><a href="/javascript-guidebook//computer-networks/frontend-security/xss"><span>XSS 攻击</span></a></li><li><a href="/javascript-guidebook//computer-networks/frontend-security/csrf"><span>CSRF 攻击</span></a></li><li><a href="/javascript-guidebook//computer-networks/frontend-security/ddos"><span>DDoS 攻击</span></a></li><li><a href="/javascript-guidebook//computer-networks/frontend-security/sql-injection"><span>SQL 注入攻击</span></a></li><li><a href="/javascript-guidebook//computer-networks/frontend-security/hijacking"><span>流量劫持</span></a></li><li><a href="/javascript-guidebook//computer-networks/frontend-security/same-origin-policy"><span>同源策略</span></a></li></ul></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="Basic 认证实例" data-depth="2" class=""><a href="/javascript-guidebook//computer-networks/http/authentication#basic-认证实例"><span>Basic 认证实例</span></a></li><li title="步骤 1：用户访问受限资源" data-depth="3" class=""><a href="/javascript-guidebook//computer-networks/http/authentication#步骤-1：用户访问受限资源"><span>步骤 1：用户访问受限资源</span></a></li><li title="步骤 2：服务端返回 401 要求身份认证" data-depth="3" class=""><a href="/javascript-guidebook//computer-networks/http/authentication#步骤-2：服务端返回-401-要求身份认证"><span>步骤 2：服务端返回 401 要求身份认证</span></a></li><li title="步骤 3：用户发送认证请求" data-depth="3" class=""><a href="/javascript-guidebook//computer-networks/http/authentication#步骤-3：用户发送认证请求"><span>步骤 3：用户发送认证请求</span></a></li><li title="步骤 4：服务端验证请求" data-depth="3" class=""><a href="/javascript-guidebook//computer-networks/http/authentication#步骤-4：服务端验证请求"><span>步骤 4：服务端验证请求</span></a></li><li title="安全缺陷" data-depth="2" class=""><a href="/javascript-guidebook//computer-networks/http/authentication#安全缺陷"><span>安全缺陷</span></a></li><li title="身份验证和实践" data-depth="2" class=""><a href="/javascript-guidebook//computer-networks/http/authentication#身份验证和实践"><span>身份验证和实践</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="http-身份验证"><a aria-hidden="true" href="#http-身份验证"><span class="icon icon-link"></span></a>HTTP 身份验证</h1><p>HTTP 提供一个用于权限控制和认证的通用框架。最常用的 HTTP 认证方案是 HTTP Basic authentication。本页介绍了通用的 HTTP 认证框架以及展示如何通过 HTTP Basic authentication 来限制权限访问您的服务器。</p><h2 id="basic-认证实例"><a aria-hidden="true" href="#basic-认证实例"><span class="icon icon-link"></span></a>Basic 认证实例</h2><p>下面通过实例来讲解 Basic 认证是如何实现的，一共分 4 个步骤。假设：</p><ol><li>用户访问的资源：<code>/protected_docs</code></li><li>用户名、密码：<code>chyingp</code>、<code>123456</code></li></ol><h3 id="步骤-1：用户访问受限资源"><a aria-hidden="true" href="#步骤-1：用户访问受限资源"><span class="icon icon-link"></span></a>步骤 1：用户访问受限资源</h3><p>如下，用户访问受限资源 <code>/protected_docs</code>。请求报文如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-http"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="GET /protected_docs HTTP/1.1
Host: 127.0.0.1:3000
" data-status="copy"></button><div class="token-line"><span class="token plain">GET /protected_docs HTTP/1.1</span></div><div class="token-line"><span class="token plain">Host: 127.0.0.1:3000</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="步骤-2：服务端返回-401-要求身份认证"><a aria-hidden="true" href="#步骤-2：服务端返回-401-要求身份认证"><span class="icon icon-link"></span></a>步骤 2：服务端返回 401 要求身份认证</h3><p>服务端发现 <code>/protected_docs</code> 为受限资源，于是向用户发送 401 状态码，要求进行身份认证。</p><div class="__dumi-default-code-block"><pre class="prism-code language-http"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="HTTP/1.1 401 Unauthorized
WWW-Authenticate: Basic realm=protected_docs
" data-status="copy"></button><div class="token-line"><span class="token plain">HTTP/1.1 401 Unauthorized</span></div><div class="token-line"><span class="token plain">WWW-Authenticate: Basic realm=protected_docs</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>响应首部中，通过<code>WWW-Authenticate</code>告知客户端，认证的方案是<code>basic</code>。同时以<code>realm</code>告知认证的范围。</p><div class="__dumi-default-code-block"><pre class="prism-code language-http"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="WWW-Authenticate: Basic realm=&lt;需要保护资源的范围&gt;
" data-status="copy"></button><div class="token-line"><span class="token plain">WWW-Authenticate: Basic realm=&lt;需要保护资源的范围&gt;</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="步骤-3：用户发送认证请求"><a aria-hidden="true" href="#步骤-3：用户发送认证请求"><span class="icon icon-link"></span></a>步骤 3：用户发送认证请求</h3><p>用户收到服务端响应后，填写用户名、密码，然后向服务端发送认证请求。</p></div><img alt="用户发送认证请求" src="/javascript-guidebook/static/authorization.16389e48.png" width="800"/><div class="markdown"><p>以下为请求报文。<code>Authorization</code>请求首部中，包含了用户填写的用户名、密码。</p><div class="__dumi-default-code-block"><pre class="prism-code language-http"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="GET /protected_docs HTTP/1.1
Authorization: Basic Y2h5aW5ncDoxMjM0NTY=
" data-status="copy"></button><div class="token-line"><span class="token plain">GET /protected_docs HTTP/1.1</span></div><div class="token-line"><span class="token plain">Authorization: Basic Y2h5aW5ncDoxMjM0NTY=</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p><code>Authorization</code>首部的格式为<code>Basic base64(userid:password)</code>。实际代码如下：</p><div class="__dumi-default-code-block"><pre class="prism-code language-http"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="Buffer.from(&#x27;chyingp:123456&#x27;).toString(&#x27;base64&#x27;); // Y2h5aW5ncDoxMjM0NTY=
" data-status="copy"></button><div class="token-line"><span class="token plain">Buffer.from(&#x27;chyingp:123456&#x27;).toString(&#x27;base64&#x27;); // Y2h5aW5ncDoxMjM0NTY=</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="步骤-4：服务端验证请求"><a aria-hidden="true" href="#步骤-4：服务端验证请求"><span class="icon icon-link"></span></a>步骤 4：服务端验证请求</h3><p>服务端收到用户的认证请求后，对请求进行验证。验证包含如下步骤：</p><ol><li>根据用户请求资源的地址，确定资源对应的 realm。</li><li>解析 Authorization 请求首部，获得用户名、密码。</li><li>判断用户是否有访问该 realm 的权限。</li><li>验证用户名、密码是否匹配。</li></ol><p>一旦上述验证通过，则返回请求资源。如果验证失败，则返回 401 要求重新认证，或者返回 403（Forbidden）。</p><h2 id="安全缺陷"><a aria-hidden="true" href="#安全缺陷"><span class="icon icon-link"></span></a>安全缺陷</h2><p>Basic 认证的安全缺陷比较明显，它通过明文传输用户的密码，这会导致严重的安全问题。</p><ol><li>在传输层未加密的情况下，用户明文密码可被中间人截获</li><li>明文密码一旦泄露，如果用户其他站点用了同样的明文密码（大概率），那么用户其他站点的安全防线也告破。</li></ol><p>关于上述问题的建议：</p><ol><li>传输层未加密的情况下，不要使用 Basic 认证。</li><li>如果使用 Basic 认证，登录密码由服务端生成。</li><li>如果可能，不要使用 Basic 认证。</li></ol><blockquote><p>除了安全缺陷，Basic 认证还存在无法吊销认证的情况。</p></blockquote><h2 id="身份验证和实践"><a aria-hidden="true" href="#身份验证和实践"><span class="icon icon-link"></span></a>身份验证和实践</h2><p><a href="https://juejin.im/entry/5a586a716fb9a01ca871e714" target="_blank" rel="noopener noreferrer">基于 Token 的身份验证和实践<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>HTTP Basic 提供的身份验证策略缺陷比较明显，当代应用较多使用 Token 的方式进行用户身份验证。</p><p>使用基于 Token 的身份验证方法，在服务端不需要存储用户的登录记录。大概的流程是这样的：</p><ol><li>客户端使用用户名跟密码请求登录</li><li>服务端收到请求，去验证用户名与密码</li><li>验证成功后，服务端会签发一个 Token，再把这个 Token 发送给客户端</li><li>客户端收到 Token 以后可以把它存储起来，比如放在 Cookie 里或者 Local Storage 里</li><li>客户端每次向服务端请求资源的时候需要带着服务端签发的 Token</li><li>服务端收到请求，然后去验证客户端请求里面带着的 Token，如果验证成功，就向客户端返回请求的数据</li></ol><hr/><p><strong>参考资料：</strong></p><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Authentication" target="_blank" rel="noopener noreferrer">MDN HTTP Authentication<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://juejin.im/entry/5ac175baf265da239e4e3999" target="_blank" rel="noopener noreferrer">一文读懂 HTTP Basic 身份认证<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/javascript-guidebook/edit/master/docs/computer-networks/http/authentication.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last Update: ">8/21/2020, 10:09:37 AM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/javascript-guidebook/umi.d057d78f.js"></script>
    <script src="/javascript-guidebook/docs__computer-networks__http__authentication.md.bd2ea526.async.js"></script>
  </body>
</html>
