<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/javascript-guidebook/umi.css" />
    <script>
      window.routerBase = "/javascript-guidebook/";
    </script>
    <script>
      //! umi version: 3.2.19
    </script>
    <title>适配方案</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/javascript-guidebook-favicon.png&#x27;)" href="/javascript-guidebook//">JavaScript Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="/javascript-guidebook//basic-concept">基本语法</a><a href="/javascript-guidebook//standard-built-in-objects">内置对象</a><a href="/javascript-guidebook//core-modules">核心模块</a><a href="/javascript-guidebook//object-oriented-programming">OOP</a><a aria-current="page" class="active" href="/javascript-guidebook//browser-object-model">BOM</a><a href="/javascript-guidebook//document-object-model">DOM</a><a href="/javascript-guidebook//computer-networks">计算机网络</a><a href="/javascript-guidebook//design-patterns">设计模式</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/javascript-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/javascript-guidebook-favicon.png&#x27;)" href="/javascript-guidebook//"></a><h1>JavaScript Guidebook</h1><p>JavaScript 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/javascript-guidebook//basic-concept">基本语法</a></li><li><a href="/javascript-guidebook//standard-built-in-objects">内置对象</a></li><li><a href="/javascript-guidebook//core-modules">核心模块</a></li><li><a href="/javascript-guidebook//object-oriented-programming">OOP</a></li><li><a aria-current="page" class="active" href="/javascript-guidebook//browser-object-model">BOM</a></li><li><a href="/javascript-guidebook//document-object-model">DOM</a></li><li><a href="/javascript-guidebook//computer-networks">计算机网络</a></li><li><a href="/javascript-guidebook//design-patterns">设计模式</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/javascript-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/javascript-guidebook//browser-object-model">BOM 浏览器对象模型</a></li><li><a href="/javascript-guidebook//browser-object-model/window">全局对象</a><ul><li><a href="/javascript-guidebook//browser-object-model/window/window"><span>Window 对象</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window/location"><span>Location 对象</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window/history"><span>History 对象</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window/screen"><span>Screen 对象</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window/navigator"><span>Navigator 对象</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/web-event">全局 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/web-event/set-interval"><span>setInterval 间歇调用</span></a></li><li><a href="/javascript-guidebook//browser-object-model/web-event/set-time-out"><span>setTimeout 超时调用</span></a></li><li><a href="/javascript-guidebook//browser-object-model/web-event/alert"><span>alert</span></a></li><li><a href="/javascript-guidebook//browser-object-model/web-event/confirm"><span>confirm</span></a></li><li><a href="/javascript-guidebook//browser-object-model/web-event/prompt"><span>prompt</span></a></li><li><a href="/javascript-guidebook//browser-object-model/web-event/drag-and-drop-api"><span>拖放 API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/web-event/request-animation-frame"><span>动画 API</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/window-position">视窗尺寸位置</a><ul><li><a href="/javascript-guidebook//browser-object-model/window-position/window-view-properties"><span>Window 对象视图属性</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window-position/screen-view-properties"><span>Screen 对象视图属性</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window-position/element-view-properties"><span>Element 文档元素视图属性</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window-position/document-view-and-element-view"><span>文档视图和元素视图</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window-position/mouse-position"><span>鼠标位置</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files">二进制数据和文件 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/local-files-application"><span>本地文件应用</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/blob"><span>Blob API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/file"><span>File API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/file-list"><span>FileList API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/file-reader"><span>FileReader API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/file-reader-sync"><span>FileReaderSync API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/url"><span>URL API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/form-data"><span>FormData API</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/connectivity">数据通信 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/connectivity/post-message"><span>PostMessage</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/xmlhttprequest"><span>XHMLHttpRequest API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/featch"><span>Fetch API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/beacon"><span>Beacon API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/web-socket"><span>WebSocket</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/event-source"><span>EventSource</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/server-sent-events"><span>Server-sent Events</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/web-real-time-communication"><span>WebRTC</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/progress-event"><span>Progress Event</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage">离线与存储 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/browser-cache"><span>浏览器缓存机制</span></a></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/http-cache"><span>HTTP Cache</span></a></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/cookie"><span>Cookie</span></a></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/web-storage"><span>Web Storage</span></a></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/web-workers"><span>Web Workers</span></a></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/service-worker"><span>Service Worker</span></a></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/indexed-db"><span>IndexedDB</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/performance">性能 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/performance/performance"><span>Performance API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/performance/performance-resource-timing"><span>Performance Resource Timing API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/performance/performance-navigation-timing"><span>Performance Navifation API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/performance/perfromance-timeline"><span>性能时间线</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/multimedia">多媒体 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/multimedia/audio"><span>音频</span></a></li><li><a href="/javascript-guidebook//browser-object-model/multimedia/video"><span>视频</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/device">设备 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/device/geolocation"><span>地理定位</span></a></li><li><a href="/javascript-guidebook//browser-object-model/device/touch-event"><span>触控事件</span></a></li><li><a href="/javascript-guidebook//browser-object-model/device/camera"><span>摄像头访问</span></a></li><li><a href="/javascript-guidebook//browser-object-model/device/the-position-object"><span>Position 对象</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/integration">集成 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/integration/full-screen"><span>全屏 API</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle">浏览器工作原理</a><ul><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/browser-architecture"><span>浏览器架构</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/workflow"><span>渲染进程的内部机制</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/construction-of-the-object-model"><span>构建对象模型</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/script-loading-asynchronously"><span>脚本异步加载</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/construction-of-render-tree"><span>渲染树构建</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/layout"><span>布局</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/paint"><span>绘制</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/composite"><span>合并</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/browser-event"><span>浏览器事件处理</span></a></li></ul></li><li><a aria-current="page" class="active" href="/javascript-guidebook//browser-object-model/wireless-development">移动开发</a><ul><li><a href="/javascript-guidebook//browser-object-model/wireless-development/mobile-web-development"><span>移动 Web</span></a></li><li><a href="/javascript-guidebook//browser-object-model/wireless-development/viewport"><span>视口</span></a></li><li><a aria-current="page" class="active" href="/javascript-guidebook//browser-object-model/wireless-development/adaptation"><span>适配方案</span></a></li></ul></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="常见的适配方案" data-depth="2" class=""><a href="/javascript-guidebook//browser-object-model/wireless-development/adaptation#常见的适配方案"><span>常见的适配方案</span></a></li><li title="流式布局" data-depth="2" class=""><a href="/javascript-guidebook//browser-object-model/wireless-development/adaptation#流式布局"><span>流式布局</span></a></li><li title="水平百分比布局" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/wireless-development/adaptation#水平百分比布局"><span>水平百分比布局</span></a></li><li title="水平弹性布局" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/wireless-development/adaptation#水平弹性布局"><span>水平弹性布局</span></a></li><li title="视口适配" data-depth="2" class=""><a href="/javascript-guidebook//browser-object-model/wireless-development/adaptation#视口适配"><span>视口适配</span></a></li><li title="Hack 实现方案" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/wireless-development/adaptation#hack-实现方案"><span>Hack 实现方案</span></a></li><li title="原生样式实现方案" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/wireless-development/adaptation#原生样式实现方案"><span>原生样式实现方案</span></a></li><li title="技术总结" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/wireless-development/adaptation#技术总结"><span>技术总结</span></a></li><li title="根元素适配" data-depth="2" class=""><a href="/javascript-guidebook//browser-object-model/wireless-development/adaptation#根元素适配"><span>根元素适配</span></a></li><li title="字体大小适配" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/wireless-development/adaptation#字体大小适配"><span>字体大小适配</span></a></li><li title="其他适配方案" data-depth="2" class=""><a href="/javascript-guidebook//browser-object-model/wireless-development/adaptation#其他适配方案"><span>其他适配方案</span></a></li><li title="固定宽度方案" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/wireless-development/adaptation#固定宽度方案"><span>固定宽度方案</span></a></li><li title="响应式方案" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/wireless-development/adaptation#响应式方案"><span>响应式方案</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="适配方案"><a aria-hidden="true" href="#适配方案"><span class="icon icon-link"></span></a>适配方案</h1><p>由于移动端的特殊性，屏幕的尺寸碎片化严重，要想很好的适配不同的尺寸的设备，需要我们前端开发相比 PC 端要做一些基层的适配方案。</p><p>关键是需要找到一种长度单位，使得一样的取值，在不同尺寸的设备屏幕上按大小比例缩放。</p><h2 id="常见的适配方案"><a aria-hidden="true" href="#常见的适配方案"><span class="icon icon-link"></span></a>常见的适配方案</h2><ul><li><a href="#%E6%B5%81%E5%BC%8F%E5%B8%83%E5%B1%80">流式布局</a></li><li>视口适配<ul><li><a href="#hack%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88">Hack 实现</a></li><li><a href="#%E5%8E%9F%E7%94%9F%E6%A0%B7%E5%BC%8F%E5%AE%9E%E7%8E%B0">原生样式实现</a></li></ul></li><li><a href="#%E6%A0%B9%E5%85%83%E7%B4%A0%E9%80%82%E9%85%8D">根元素适配</a></li><li>其他适配方案<ul><li><a href="#%E5%9B%BA%E5%AE%9A%E5%AE%BD%E5%BA%A6%E6%96%B9%E6%A1%88">固定宽度方案</a></li><li><a href="#%E5%93%8D%E5%BA%94%E5%BC%8F%E6%96%B9%E6%A1%88">响应式方案</a></li></ul></li></ul><h2 id="流式布局"><a aria-hidden="true" href="#流式布局"><span class="icon icon-link"></span></a>流式布局</h2><p>流式布局即使用百分比定义宽度与固定绝对高度的布局方案。</p><p>此方案的前提是设置屏幕为理想视口，然后通过水平百分比布局或者弹性布局，垂直方向一般用固定像素。</p><p><strong>优点</strong></p><ul><li>布局快速简单方便，在移动设备中水平表现良好差异不大</li></ul><p><strong>缺点</strong></p><ul><li>垂直方向像素恒定，可能水平很宽的屏幕会被拉伸变形严重，显示效果不协调</li><li>高倍屏幕上 1 像素可能被多倍的物理像素显示，会变的非常粗</li><li>大量百分比布局存在许多兼容性问题</li></ul><p><strong>特点</strong></p><ul><li>固定屏幕为理想视口宽度</li><li>少许的媒体查询设置字体</li><li>水平百分比布局或弹性布局</li><li>垂直方向像素恒定</li></ul><h3 id="水平百分比布局"><a aria-hidden="true" href="#水平百分比布局"><span class="icon icon-link"></span></a>水平百分比布局</h3><div class="__dumi-default-code-block"><pre class="prism-code language-html"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="&lt;html&gt;
  &lt;meta
    name=&quot;viewport&quot;
    content=&quot;width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no&quot;
  /&gt;
  &lt;header&gt;&lt;/header&gt;
&lt;/html&gt;
" data-status="copy"></button><div class="token-line"><span class="token tag punctuation">&lt;</span><span class="token tag">html</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token tag punctuation">&lt;</span><span class="token tag">meta</span><span class="token tag"></span></div><div class="token-line"><span class="token tag">    </span><span class="token tag attr-name">name</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">viewport</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"></span></div><div class="token-line"><span class="token tag">    </span><span class="token tag attr-name">content</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"></span></div><div class="token-line"><span class="token tag">  </span><span class="token tag punctuation">/&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token tag punctuation">&lt;</span><span class="token tag">header</span><span class="token tag punctuation">&gt;</span><span class="token tag punctuation">&lt;/</span><span class="token tag">header</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token tag punctuation">&lt;/</span><span class="token tag">html</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>样式：</p><div class="__dumi-default-code-block"><pre class="prism-code language-less"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="header {
  /* 宽度默认100% */
  height: 45px;
  line-height: 45px;
  background-color: #00b38a;
  color: #fff;
  /* 可根据媒体查询适当调整字体大小 */
  font-size: 1.8rem;
  text-align: center;
  position: relative;
}
" data-status="copy"></button><div class="token-line"><span class="token selector">header</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">/* 宽度默认100% */</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">height</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token number">45</span><span class="token unit">px</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">line-height</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token number">45</span><span class="token unit">px</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">background-color</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token hexcode">#00b38a</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">color</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token hexcode">#fff</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">/* 可根据媒体查询适当调整字体大小 */</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">font-size</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token number">1.8</span><span class="token unit">rem</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">text-align</span><span class="token punctuation">:</span><span class="token plain"> center</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">position</span><span class="token punctuation">:</span><span class="token plain"> relative</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="水平弹性布局"><a aria-hidden="true" href="#水平弹性布局"><span class="icon icon-link"></span></a>水平弹性布局</h3><div class="__dumi-default-code-block"><pre class="prism-code language-html"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="&lt;style&gt;&lt;/style&gt;

&lt;header&gt;
  &lt;span class=&quot;layout&quot;&gt;水平弹性布局&lt;/span&gt;
  &lt;a href=&quot;#&quot; class=&quot;login&quot;&gt;登陆&lt;/a&gt;
&lt;/header&gt;
" data-status="copy"></button><div class="token-line"><span class="token tag punctuation">&lt;</span><span class="token tag">style</span><span class="token tag punctuation">&gt;</span><span class="token style"></span><span class="token tag punctuation">&lt;/</span><span class="token tag">style</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token tag punctuation">&lt;</span><span class="token tag">header</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token tag punctuation">&lt;</span><span class="token tag">span</span><span class="token tag"> </span><span class="token tag attr-name">class</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">layout</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token plain">水平弹性布局</span><span class="token tag punctuation">&lt;/</span><span class="token tag">span</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token tag punctuation">&lt;</span><span class="token tag">a</span><span class="token tag"> </span><span class="token tag attr-name">href</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">#</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">class</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">login</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token plain">登陆</span><span class="token tag punctuation">&lt;/</span><span class="token tag">a</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token tag punctuation">&lt;/</span><span class="token tag">header</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>样式：</p><div class="__dumi-default-code-block"><pre class="prism-code language-css"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="header {
  height: 45px;
  display: flex;
  justify-content: space-between;
  line-height: 45px;
}
" data-status="copy"></button><div class="token-line"><span class="token selector">header</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">height</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token number">45</span><span class="token unit">px</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">display</span><span class="token punctuation">:</span><span class="token plain"> flex</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">justify-content</span><span class="token punctuation">:</span><span class="token plain"> space-between</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token property">line-height</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token number">45</span><span class="token unit">px</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="视口适配"><a aria-hidden="true" href="#视口适配"><span class="icon icon-link"></span></a>视口适配</h2><p>讨论方案之前，需要先了解三个关键概念：</p><ul><li><a href="viewport.md">设备像素密度</a>（Pixel Per Inch，PPI）：现实世界的一英寸内像素数，决定了屏幕的显示质量</li><li><a href="viewport.md">设备像素比率</a>（Device Pixel Ratio，DPR）：物理像素与逻辑像素（px）的对应关系</li><li><a href="viewport.md">分辨率</a>（Resolution）：屏幕区域的宽高所占像素数</li></ul><p>《使用 Flexible 实现手淘 H5 页面的终端适配》</p><ul><li>开发直接按照设计稿编写固定尺寸元素</li><li>页面加载完成后用 JavaScript 动态根据 DPR 改变页面的缩放量</li><li>推荐使用方案：Flexible 方案（目前手淘已经升级 2.0 版本）</li></ul><p>这种方案实现方式有多种 <a href=""></a> 介绍了淘宝实现方案和网易新闻实现的方案。</p><h3 id="hack-实现方案"><a aria-hidden="true" href="#hack-实现方案"><span class="icon icon-link"></span></a>Hack 实现方案</h3><p>Flexible 方案：综合运用 <code>rem</code> 和 <code>px</code> 两种单位相互转换，并通过 Hack 手段根据设备的 DPR 值相应改变的 <code>&lt;meta&gt;</code> 标签中的 viewport 的 <code>scale</code> 值和 <code>html</code> 字体大小的值（根据官方说法属于过渡方案，现 2019.2 已升级 2.0 版本）</p><ul><li>根据 DPR 的值来修改 viewport 实现 <code>1px</code> 的线</li><li>根据 DPR 的值来修改 <code>&lt;html&gt;</code> 的 <code>font-size</code>，从而使用 <code>rem</code> 实现等比缩放</li><li>使用 Hack 手段用 <code>rem</code> 模拟 <code>vw</code> 特性</li></ul><h4 id="设置理想视口"><a aria-hidden="true" href="#设置理想视口"><span class="icon icon-link"></span></a>设置理想视口</h4><p>设置理想视口，使得<strong>布局视口</strong>与<strong>视觉视口</strong>一样大，DOM 文档主宽度即为屏幕宽度。</p><p>单个 CSS 像素（<code>1px</code>）由多少设备像素显示由具体设备而不同。</p><h4 id="动态设置视口缩放"><a aria-hidden="true" href="#动态设置视口缩放"><span class="icon icon-link"></span></a>动态设置视口缩放</h4><p>对于 Android，所有设备缩放设为 1。对于 iOS，根据 DPR 不同，设置其缩放为 DPR 倒数。</p><p>设置页面缩放可以使得单个 CSS 像素（<code>1px</code>）由单个设备像素来显示，从而提高显示精度。因此，设置 <code>1 / dpr</code> 的缩放视口，可以画出 <code>1px</code> 的边框。</p><p>不管页面中有没有设置 viewport，若无，则设置，若有，则改写，设置其 scale 为 <code>1/dpr</code>。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// flexible.js
if (!dpr &amp;&amp; !scale) {
  var isAndroid = win.navigator.appVersion.match(/android/gi);
  var isIPhone = win.navigator.appVersion.match(/iphone/gi);
  var devicePixelRatio = win.devicePixelRatio;
  if (isIPhone) {
    // iOS下，对于2和3的屏，用2倍的方案，其余的用1倍方案
    if (devicePixelRatio &gt;= 3 &amp;&amp; (!dpr || dpr &gt;= 3)) {
      dpr = 3;
    } else if (devicePixelRatio &gt;= 2 &amp;&amp; (!dpr || dpr &gt;= 2)) {
      dpr = 2;
    } else {
      dpr = 1;
    }
  } else {
    // 其他设备下，仍旧使用1倍的方案
    dpr = 1;
  }
  scale = 1 / dpr;
}

docEl.setAttribute(&#x27;data-dpr&#x27;, dpr);
if (!metaEl) {
  metaEl = doc.createElement(&#x27;meta&#x27;);
  metaEl.setAttribute(&#x27;name&#x27;, &#x27;viewport&#x27;);
  metaEl.setAttribute(
    &#x27;content&#x27;,
    &#x27;initial-scale=&#x27; +
      scale +
      &#x27;, maximum-scale=&#x27; +
      scale +
      &#x27;, minimum-scale=&#x27; +
      scale +
      &#x27;, user-scalable=no&#x27;
  );
  if (docEl.firstElementChild) {
    docEl.firstElementChild.appendChild(metaEl);
  } else {
    var wrap = doc.createElement(&#x27;div&#x27;);
    wrap.appendChild(metaEl);
    doc.write(wrap.innerHTML);
  }
}

function refreshRem() {
  var width = docEl.getBoundingClientRect().width;
  if (width / dpr &gt; 540) {
    width = 540 * dpr;
  }
  var rem = width / 10;
  docEl.style.fontSize = rem + &#x27;px&#x27;;
  flexible.rem = win.rem = rem;
}
" data-status="copy"></button><div class="token-line"><span class="token comment">// flexible.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token plain">dpr </span><span class="token operator">&amp;&amp;</span><span class="token plain"> </span><span class="token operator">!</span><span class="token plain">scale</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">var</span><span class="token plain"> isAndroid </span><span class="token operator">=</span><span class="token plain"> win</span><span class="token punctuation">.</span><span class="token property-access">navigator</span><span class="token punctuation">.</span><span class="token property-access">appVersion</span><span class="token punctuation">.</span><span class="token method function property-access">match</span><span class="token punctuation">(</span><span class="token regex">/android/gi</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">var</span><span class="token plain"> isIPhone </span><span class="token operator">=</span><span class="token plain"> win</span><span class="token punctuation">.</span><span class="token property-access">navigator</span><span class="token punctuation">.</span><span class="token property-access">appVersion</span><span class="token punctuation">.</span><span class="token method function property-access">match</span><span class="token punctuation">(</span><span class="token regex">/iphone/gi</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">var</span><span class="token plain"> devicePixelRatio </span><span class="token operator">=</span><span class="token plain"> win</span><span class="token punctuation">.</span><span class="token property-access">devicePixelRatio</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">isIPhone</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// iOS下，对于2和3的屏，用2倍的方案，其余的用1倍方案</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">devicePixelRatio </span><span class="token operator">&gt;=</span><span class="token plain"> </span><span class="token number">3</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token plain">dpr </span><span class="token operator">||</span><span class="token plain"> dpr </span><span class="token operator">&gt;=</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      dpr </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">else</span><span class="token plain"> </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">devicePixelRatio </span><span class="token operator">&gt;=</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token plain">dpr </span><span class="token operator">||</span><span class="token plain"> dpr </span><span class="token operator">&gt;=</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      dpr </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">else</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      dpr </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">else</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// 其他设备下，仍旧使用1倍的方案</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    dpr </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  scale </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain"> dpr</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">docEl</span><span class="token punctuation">.</span><span class="token method function property-access">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#x27;data-dpr&#x27;</span><span class="token punctuation">,</span><span class="token plain"> dpr</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token plain">metaEl</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  metaEl </span><span class="token operator">=</span><span class="token plain"> doc</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">&#x27;meta&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  metaEl</span><span class="token punctuation">.</span><span class="token method function property-access">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#x27;name&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;viewport&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  metaEl</span><span class="token punctuation">.</span><span class="token method function property-access">setAttribute</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token string">&#x27;content&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token string">&#x27;initial-scale=&#x27;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      scale </span><span class="token operator">+</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token string">&#x27;, maximum-scale=&#x27;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      scale </span><span class="token operator">+</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token string">&#x27;, minimum-scale=&#x27;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      scale </span><span class="token operator">+</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token string">&#x27;, user-scalable=no&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">docEl</span><span class="token punctuation">.</span><span class="token property-access">firstElementChild</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    docEl</span><span class="token punctuation">.</span><span class="token property-access">firstElementChild</span><span class="token punctuation">.</span><span class="token method function property-access">appendChild</span><span class="token punctuation">(</span><span class="token plain">metaEl</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">else</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">var</span><span class="token plain"> wrap </span><span class="token operator">=</span><span class="token plain"> doc</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">&#x27;div&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    wrap</span><span class="token punctuation">.</span><span class="token method function property-access">appendChild</span><span class="token punctuation">(</span><span class="token plain">metaEl</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    doc</span><span class="token punctuation">.</span><span class="token method function property-access">write</span><span class="token punctuation">(</span><span class="token plain">wrap</span><span class="token punctuation">.</span><span class="token property-access">innerHTML</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">refreshRem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">var</span><span class="token plain"> width </span><span class="token operator">=</span><span class="token plain"> docEl</span><span class="token punctuation">.</span><span class="token method function property-access">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">width</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">width </span><span class="token operator">/</span><span class="token plain"> dpr </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">540</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    width </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">540</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> dpr</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">var</span><span class="token plain"> rem </span><span class="token operator">=</span><span class="token plain"> width </span><span class="token operator">/</span><span class="token plain"> </span><span class="token number">10</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  docEl</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">fontSize</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> rem </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string">&#x27;px&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  flexible</span><span class="token punctuation">.</span><span class="token property-access">rem</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> win</span><span class="token punctuation">.</span><span class="token property-access">rem</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> rem</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>DOM 元素设定：</p><div class="__dumi-default-code-block"><pre class="prism-code language-html"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="&lt;html data-dpr=&quot;2&quot; style=&quot;font-size: 100px&quot;&gt;&lt;/html&gt;
" data-status="copy"></button><div class="token-line"><span class="token tag punctuation">&lt;</span><span class="token tag">html</span><span class="token tag"> </span><span class="token tag attr-name">data-dpr</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">2</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag style-attr language-css attr-name"> </span><span class="token tag style-attr language-css attr-name">style</span><span class="token tag style-attr language-css punctuation">=&quot;</span><span class="token tag style-attr language-css attr-value property">font-size</span><span class="token tag style-attr language-css attr-value punctuation">:</span><span class="token tag style-attr language-css attr-value"> </span><span class="token tag style-attr language-css attr-value number">100</span><span class="token tag style-attr language-css attr-value unit">px</span><span class="token tag style-attr language-css punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token tag punctuation">&lt;/</span><span class="token tag">html</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><ul><li>根据不同的设备规划不同的布局（<code>font-size</code> 是不同设备上用 <code>rem</code> 的基准值）</li><li>任何分辨率下字体需要保持一致（<code>data-dpr</code> 针对字体设置）</li></ul><p>⚠️ 注意：通过一段 JavaScript 代码根据设备的屏幕宽度、DPR 设置根元素的 <code>data-dpr</code> 和 <code>font-size</code>，这段 JavaScript 代码要在所有资源加载之前执行，建议做内联处理。</p><p><strong>设置缩放视口和设置理想视口有什么不同？</strong></p><p>问题：Viewport 设为理想视口（<code>scale=1</code>），基本已经满足适配，为什么要动态设置 Viewport 缩放？</p><p>原因：以 iPhone6 为例，DPR 为 2，缩放设为 0.5，则布局视口为 750，缩放后显示刚好为视觉视口 375，而总的 CSS 像素（逻辑像素）其实是 750，与设备像素一致，这样 <code>1px</code> 的 CSS 像素，占用的物理像素也是 1。而 viewport 设置缩放为 1 的理想视口情况下，布局视口为 375，显示也刚好是屏幕宽度，然而 <code>1px</code> 的 CSS 像素，占用的物理像素是 2。这样说来，这样设置可以实现 <code>1px</code> 的线条在二倍屏的显示。如此实现的原因是 CSS 像素与设备像素的关系依赖于屏幕缩放。</p><p>验证：</p><ul><li>设备：iPhone6，在 <code>scale=0.5</code> 时，<code>1px</code> 边框显示效果<ul><li>在 <code>scale=1.0</code> 时，<code>1px</code> 边框显示效果</li><li>在 <code>scale=0.5</code> 时，<code>2px</code> 边框显示效果</li></ul></li><li>通过对比后发现，在 <code>scale=0.5</code> 时，<code>1px</code> 的线比 <code>scale=1.0</code> 要细，这也就解决了 <code>1px</code> 线条的显示问题</li></ul><h4 id="单位转换混合宏"><a aria-hidden="true" href="#单位转换混合宏"><span class="icon icon-link"></span></a>单位转换混合宏</h4><div class="__dumi-default-code-block"><pre class="prism-code language-scss"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// 使用 Sass 的混合宏
// 淘宝手淘的方案里，iPhone6(375pt)屏幕宽度为10rem，即font-size=75px, scale=0.5 因设计图为二倍图，$base-font-size=75px

@mixin px2rem($property, $px-values, $baseline-px: 16px, $support-for-ie: false) {
  //Conver the baseline into rems
  $baseline-rem: $baseline-px / 1rem * 1;
  //Print the first line in pixel values
  @if $support-for-ie {
    #{$property}: $px-values;
  }
  //if there is only one (numeric) value, return the property/value line for it.
  @if type-of($px-values) == &#x27;number&#x27; {
    #{$property}: $px-values / $baseline-rem;
  } @else {
    //Create an empty list that we can dump values into
    $rem-values: ();
    @each $value in $px-values {
      // If the value is zero or not a number, return it
      @if $value == 0 or type-of($value) != &#x27;number&#x27; {
        $rem-values: append($rem-values, $value / $baseline-rem);
      }
    }
    // Return the property and its list of converted values
    #{$property}: $rem-values;
  }
}
" data-status="copy"></button><div class="token-line"><span class="token comment">// 使用 Sass 的混合宏</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 淘宝手淘的方案里，iPhone6(375pt)屏幕宽度为10rem，即font-size=75px, scale=0.5 因设计图为二倍图，$base-font-size=75px</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">@mixin</span><span class="token plain"> px</span><span class="token number">2</span><span class="token unit">rem</span><span class="token punctuation">(</span><span class="token variable">$property</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token variable">$px-values</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token variable">$baseline-px</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token number">16</span><span class="token unit">px</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token variable">$support-for-ie</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">//Conver the baseline into rems</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token variable">$baseline-rem</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token variable">$baseline-px</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain"> </span><span class="token number">1</span><span class="token unit">rem</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">//Print the first line in pixel values</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">@if</span><span class="token plain"> </span><span class="token selector variable">$support-for-ie</span><span class="token selector"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token variable">#{$property}</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token variable">$px-values</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">//if there is only one (numeric) value, return the property/value line for it.</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">@if</span><span class="token plain"> </span><span class="token function">type-of</span><span class="token punctuation">(</span><span class="token variable">$px-values</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token selector">== &#x27;number&#x27; </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token variable">#{$property}</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token variable">$px-values</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain"> </span><span class="token variable">$baseline-rem</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">@else</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">//Create an empty list that we can dump values into</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token variable">$rem-values</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">@each</span><span class="token plain"> </span><span class="token selector variable">$value</span><span class="token selector"> in </span><span class="token selector variable">$px-values</span><span class="token selector"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// If the value is zero or not a number, return it</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">@if</span><span class="token plain"> </span><span class="token variable">$value</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token operator">or</span><span class="token plain"> </span><span class="token function">type-of</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token selector">!= &#x27;number&#x27; </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token variable">$rem-values</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$rem-values</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token variable">$value</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain"> </span><span class="token variable">$baseline-rem</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// Return the property and its list of converted values</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token variable">#{$property}</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token variable">$rem-values</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="原生样式实现方案"><a aria-hidden="true" href="#原生样式实现方案"><span class="icon icon-link"></span></a>原生样式实现方案</h3><p>移动布局需要面对两个最为重要的问题：</p><ul><li>各终端下的适配问题</li><li>Retina 屏的细节处理</li></ul><p>不同终端，开发者需要面对屏幕分辨率、DPR、<code>1px</code>、<code>@2x</code> 图等一系列问题。</p><p>这个布局方案也是针对性的解决这些问题，只不过解决这些问题不再是使用 Hack 手段来处理，而是直接使用原生的 CSS 技术来处理的。著作权归作者所有。</p><p>Flexbile 方案通过 JavaScript 模拟 <code>vw</code> 的特性，如今，<code>vw</code> 已经得到了众多浏览器支持。</p><p><code>vw</code> 是基于 Viewport 视窗的长度单位，这里的视窗（Viewport）指的是浏览器可视化的区域，而这个可视区域是 <code>window.innerWidth / window.innerHeight</code> 的大小。</p><blockquote><p>浏览器相关尺寸信息获取（以高度为例）：</p><ul><li><code>screen.height</code>：屏幕高度</li><li><code>screen.availHeight</code>：屏幕可用高度</li><li><code>screen.height - screen.availHeight</code>：任务栏高度</li><li><code>window.outerHeight</code>：浏览器高度</li><li><code>window.innerHeight</code>：页面可用高度</li><li><code>window.outerHeight - window.innerHeight</code>：工具栏高度</li><li><code>body.clientHeigh</code>：Body 展示高度</li><li><code>window.innerHeight - body.clientHeight</code>：滚动条</li><li><code>body.offsetHeight</code>：Body 总高度</li></ul></blockquote><p>在 <a href="https://www.w3.org/TR/css3-values/" target="_blank" rel="noopener noreferrer">CSS Values and Units Module Level 3<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 中和 Viewport 相关的单位有四个，分别为 <code>vw</code>、<code>vh</code>、<code>vmin</code> 和 <code>vmax</code>。</p><ul><li><code>vw</code>：是 Viewport&#x27;s width 的简写，<code>1vw</code> 等于 <code>window.innerWidth</code> 的 <code>1%</code></li><li><code>vh</code>：和 <code>vw</code> 类似，是 Viewport&#x27;s height 的简写，<code>1vh</code> 等于 <code>window.innerHeihgt</code> 的 <code>1%</code></li><li><code>vmin</code>：<code>vmin</code> 的值是当前 <code>vw</code> 和 <code>vh</code> 中较小的值</li><li><code>vmax</code>：<code>vmax</code> 的值是当前 <code>vw</code> 和 <code>vh</code> 中较大的值</li></ul><blockquote><p><code>vmin</code> 和 <code>vmax</code> 是根据 Viewport 中长度偏大的那个维度值计算出来的，如果 <code>window.innerHeight &gt; window.innerWidth</code> 则 <code>vmin</code> 取百分之一的 <code>window.innerWidth</code>，<code>vmax</code> 取百分之一的 <code>window.innerHeight</code> 计算。</p></blockquote></div><img alt="ViewportUnit" src="/javascript-guidebook/static/viewport-unit.44d6edda.png" width="800"/><div class="markdown"><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="(function flexible(window, document){
    var docEl = document.documentElement
    var dpr = window.devicePixelRatio || 1

    // adjust body font size
    function setBodyFontSize(){
        if (document.body){
            document.body.style.fontSize = (12 * dpr) + &#x27;px&#x27;
        } else {
            document.addEventListener(&#x27;DOMContentLoaded&#x27;, setBodyFontSize)
        }
    }

    setBodyFontSize()

    // set 1rem = viewWidth / 10
    function setRemUnit(){
        var rem = docEl.clientWidth / 10
        docEl.stlye.fontSize = rem + &#x27;px&#x27;
    }

    setRemUnit()

    // reset rem unit on page resize
    window.addEventListener(&#x27;resize&#x27;, setRemUnit)
    window.addEventListener(&#x27;pageshow&#x27;, function(e){
        if (e.persisted){
            setRemUnit()
        }
    })

    // detect 0.5px supports
    if (dpr &gt;= 2){
        var fakeBody = document.createElement(&#x27;body&#x27;)
        var testElement = document.createElement(&#x27;div&#x27;)
        testElement.stlye.border = .5px solid transparent
        fakeBody.append(testElement)
        docEl.appendChil(fakeBody)
        if (testElement.offsetHeight === 1){
            docEl.classList.add(&#x27;hairlines&#x27;)
        }
        docEl.removeChild(fakeBody)
    }
})(window, document)
" data-status="copy"></button><div class="token-line"><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">flexible</span><span class="token punctuation">(</span><span class="token parameter">window</span><span class="token parameter punctuation">,</span><span class="token parameter"> document</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">var</span><span class="token plain"> docEl </span><span class="token operator">=</span><span class="token plain"> </span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">documentElement</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">var</span><span class="token plain"> dpr </span><span class="token operator">=</span><span class="token plain"> </span><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">devicePixelRatio</span><span class="token plain"> </span><span class="token operator">||</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// adjust body font size</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">setBodyFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">style</span><span class="token punctuation">.</span><span class="token property-access">fontSize</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token number">12</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> dpr</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string">&#x27;px&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">else</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#x27;DOMContentLoaded&#x27;</span><span class="token punctuation">,</span><span class="token plain"> setBodyFontSize</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">setBodyFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// set 1rem = viewWidth / 10</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">setRemUnit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">var</span><span class="token plain"> rem </span><span class="token operator">=</span><span class="token plain"> docEl</span><span class="token punctuation">.</span><span class="token property-access">clientWidth</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        docEl</span><span class="token punctuation">.</span><span class="token property-access">stlye</span><span class="token punctuation">.</span><span class="token property-access">fontSize</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> rem </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string">&#x27;px&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">setRemUnit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// reset rem unit on page resize</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#x27;resize&#x27;</span><span class="token punctuation">,</span><span class="token plain"> setRemUnit</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#x27;pageshow&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">e</span><span class="token punctuation">.</span><span class="token property-access">persisted</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token function">setRemUnit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// detect 0.5px supports</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">dpr </span><span class="token operator">&gt;=</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">var</span><span class="token plain"> fakeBody </span><span class="token operator">=</span><span class="token plain"> </span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">&#x27;body&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">var</span><span class="token plain"> testElement </span><span class="token operator">=</span><span class="token plain"> </span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">&#x27;div&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        testElement</span><span class="token punctuation">.</span><span class="token property-access">stlye</span><span class="token punctuation">.</span><span class="token property-access">border</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">.5</span><span class="token plain">px solid transparent</span></div><div class="token-line"><span class="token plain">        fakeBody</span><span class="token punctuation">.</span><span class="token method function property-access">append</span><span class="token punctuation">(</span><span class="token plain">testElement</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        docEl</span><span class="token punctuation">.</span><span class="token method function property-access">appendChil</span><span class="token punctuation">(</span><span class="token plain">fakeBody</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">testElement</span><span class="token punctuation">.</span><span class="token property-access">offsetHeight</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            docEl</span><span class="token punctuation">.</span><span class="token property-access">classList</span><span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token string">&#x27;hairlines&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        docEl</span><span class="token punctuation">.</span><span class="token method function property-access">removeChild</span><span class="token punctuation">(</span><span class="token plain">fakeBody</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token dom variable">window</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token dom variable">document</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p><strong><code>px</code> 和 <code>vw</code> 的转换问题</strong></p><p>标准设计稿使用 <code>750px</code> 作为宽度，则可得 <code>100vw = 750px</code>，即 <code>1vw = 7.5px</code>。</p><p>那么我们可以根据设计图上的 <code>px</code> 值直接转换成对应的 <code>vw</code> 值。可通过 PostCSS 插件 <a href="https://github.com/evrone/postcss-px-to-viewport" target="_blank" rel="noopener noreferrer">post-px-to-viewport<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 实现。</p><ul><li>容器适配可以使用 <code>vw</code></li><li>文本适配可以使用 <code>vw</code></li><li>大于 <code>1px</code> 的边框、圆角、阴影都可以使用 <code>vw</code></li><li>内边距和外边距可以使用 <code>vw</code></li></ul><h4 id="需要考虑的问题"><a aria-hidden="true" href="#需要考虑的问题"><span class="icon icon-link"></span></a>需要考虑的问题</h4><p><strong>容器长宽比问题</strong></p><ul><li><a href="https://www.w3cplus.com/css/aspect-ratio.html" target="_blank" rel="noopener noreferrer">CSS 实现长宽比的几种方案<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://www.w3cplus.com/css/aspect-ratio-boxes.html" target="_blank" rel="noopener noreferrer">容器长宽比<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://www.w3cplus.com/css/experiments-in-fixed-aspect-ratios.html" target="_blank" rel="noopener noreferrer">Web 中如何实现纵横比<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://www.w3cplus.com/css/css-polyfluidsizing-using-calc-vw-breakpoints-and-linear-equations.html" target="_blank" rel="noopener noreferrer">实现精准的流体排版原理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><p>目前 PostCSS 插件只是一个过渡方案，将来我们可以直接在 CSS 中使用 <code>aspect-ratio</code> 属性来实现长宽比；</p><p><strong>解决单元素问题</strong></p><p>对于 <code>1px</code> 是不建议将其转换成对应的 <code>vw</code> 单位的，但在 Retina 下，我们始终是需要面对如何解决 <code>1px</code> 的问题。在《<a href="https://www.w3cplus.com/css/fix-1px-for-retina.html" target="_blank" rel="noopener noreferrer">再谈 Retina 下 <code>1px</code> 的解决方案<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>》文章中提供了多种解决 <code>1px</code> 的方案。在这里的话，个人推荐另外一种解决<code>1px</code> 的方案。依旧是使用 PostCSS 插件，解决 <code>1px</code> 可以使用 <a href="https://github.com/jonathantneal/postcss-write-svg" target="_blank" rel="noopener noreferrer">postcss-write-svg<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p><h3 id="技术总结"><a aria-hidden="true" href="#技术总结"><span class="icon icon-link"></span></a>技术总结</h3><ul><li>使用 <code>vw</code> 实现页面适配，并且通过 PostCSS 插件 <a href="https://github.com/evrone/postcss-px-to-viewport" target="_blank" rel="noopener noreferrer">postcss-px-to-viewport<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 把 <code>px</code> 转换成 <code>vw</code>。这样实现的做法便于开发者开发，无须用在开发过程中进行任何计算，只需要根据设计图写 <code>px</code> 单位。</li><li>为了更好的实现长宽比，特别针对于 <code>ima</code>、<code>video</code>、<code>iframe</code> 元素，通过 PostCSS 插件 <code>postcss-aspect-ratio-mini</code> 来实现，在实际使用中，只需把对应的宽高写进去即可</li><li>为了解决 <code>1px</code> 问题，使用 PostCSS 插件 <code>postcss-write-svg</code>自动生成 <code>border-image</code> 或者 <code>background-image</code> 的图片</li></ul><h2 id="根元素适配"><a aria-hidden="true" href="#根元素适配"><span class="icon icon-link"></span></a>根元素适配</h2><p><code>rem</code>（font size of the root element）是指相对于根元素的字体大小的单位。简单的说它就是一个相对单位。看到 <code>rem</code> 大家一定会想起 <code>em</code> 单位，<code>em</code>（font size of the element）是指相对于父元素的字体大小的单位。它们之间其实很相似，只不过一个计算的规则是依赖根元素一个是依赖父元素计算。</p><p>关于 <code>rem</code> 更多的解读，建议可以阅读本文末附的腾讯一团队的文章<a href="http://www.cocoachina.com/webapp/20141224/10746.html" target="_blank" rel="noopener noreferrer">《Web app 变革之 rem》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p><p>把与元素尺寸相关的样式，包括 <code>height</code> <code>width</code> <code>padding</code> <code>margin</code> <code>line-height</code> 等以 <code>rem</code> 作为单位。</p><p>根据这个特点，可以根据设备宽度动态设置根元素的 <code>font-size</code>，使得以 <code>rem</code> 为单位的元素在不同终端上以相对一致的视觉效果呈现。</p><p>选取一个设备宽度作为基准，设置其根元素大小，其他设备根据此比例计算其根元素大小。比如使得 iPhone6 根元素 <code>font-size: 16px</code>。</p><table><thead><tr><th>设备</th><th>设备宽度</th><th>根元素 <code>font-size</code>/px</th><th>宽度/rem</th></tr></thead><tbody><tr><td>iPhone5</td><td>320</td><td>JavaScript 计算所得</td><td>--</td></tr><tr><td>iPhone6</td><td>375</td><td>16</td><td>23.4375</td></tr><tr><td>iPhone6 Plus</td><td>414</td><td>JavaScript 计算所得</td><td>--</td></tr><tr><td>--</td><td>360</td><td>JavaScript 计算所得</td><td>--</td></tr></tbody></table><p>根元素 <code>font-size</code> 公式：<code>width / fontSize = baseWidth / baseFontSize</code></p><p>其中，<code>baseWidth / baseFontSize</code> 是选为基准的设备宽度及其根元素字体大小，<code>width / fontSize</code> 为所求设备的宽度及其根元素大小。</p><p>特点：</p><ul><li><code>rem</code> 的大小取值：根据页面的 dpr 动态改变</li><li><code>rem</code> 的取值，<code>1rem = 100px</code> 或 <code>1rem = 1/10 * 理想视口的宽度</code></li><li>Chrome 浏览器字体小于 12px（会被重置为 12px）</li></ul><p>缺点：</p><ul><li>某些 Android 机型会丢失 <code>rem</code> 小数部分</li><li>占用了 <code>rem</code> 单位</li><li>不是纯 CSS 方案</li></ul><h3 id="字体大小适配"><a aria-hidden="true" href="#字体大小适配"><span class="icon icon-link"></span></a>字体大小适配</h3><p>在宽高中使用 rem 单位，是为了保证在不同宽度尺寸的设备中能够保证布局的等比例缩放。</p><p>首先，字体尺寸使用 rem 而非 px 的原因是，换算之后出现比较怪异的数值，尤为明显的是小数位，比如 <code>13.777px</code> 之类的数值。在浏览器中，不同浏览器队小数点的计算存在偏差，而且有些带小数点的 <code>font-size</code> 值在待定的浏览器显示并不够清晰。</p><p>其次，我们并不希望在小屏幕下面显示跟大屏幕同等量的字体。并且如果使用 <code>rem</code> 的话，那么由于等比例的存在，在小屏幕下就会存在小屏幕字体更小的情况，不利于我们更好的去阅读，违背了适配的初衷。所以，对于字体的适配，更好的做法就是使用 px 和媒体查询来进行适配。</p><p>由于 Retina 屏幕下 DPR 的不同，我们又想显示的字体一样大，于是就给字体再增大 DPR 的倍数，这样当缩小 DPR 倍的时候，那么字体也就和设计稿所示的大小一样大了，在不同的手机中显示的大小也是一致的。</p><h2 id="其他适配方案"><a aria-hidden="true" href="#其他适配方案"><span class="icon icon-link"></span></a>其他适配方案</h2><h3 id="固定宽度方案"><a aria-hidden="true" href="#固定宽度方案"><span class="icon icon-link"></span></a>固定宽度方案</h3><p>固定页面宽度的做法，早期有些网站把页面设置成 320 的宽度，超出部分留白，这样做视觉，前端都挺开心，视觉在也不用被流式布局限制自己的设计灵感了，前端也不用在搞坑爹的流式布局。但是这种解决方案也是存在一些问题，例如在大屏幕手机下两边是留白的，还有一个就是大屏幕手机下看起来页面会特别小，操作的按钮也很小。</p><h3 id="响应式方案"><a aria-hidden="true" href="#响应式方案"><span class="icon icon-link"></span></a>响应式方案</h3><p>响应式这种方式在国内很少有大型企业的复杂性的网站在移动端用这种方法去做，主要原因是工作大，维护性难，所以一般都是中小型的门户或者博客类站点会采用响应式的方法从 WebPage 到 WebApp 直接一步到位，因为这样反而可以节约成本，不用再专门为自己的网站做一个 WebApp 的版本。</p><hr/><p><strong>参考资料：</strong></p><ul><li><a href="http://www.cocoachina.com/webapp/20141224/10746.html" target="_blank" rel="noopener noreferrer">WebAPP 变革之 rem<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="http://www.html-js.com/article/2402" target="_blank" rel="noopener noreferrer">手机淘宝的 flexible 设计与实现<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://www.cnblogs.com/well-nice/p/5509589.html" target="_blank" rel="noopener noreferrer">淘宝无限适配移动端 REM 布局详解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/javascript-guidebook/edit/master/docs/browser-object-model/wireless-development/adaptation.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last Update: ">9/7/2020, 4:44:33 AM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/javascript-guidebook/umi.js"></script>
    <script src="/javascript-guidebook/docs__browser-object-model__wireless-development__adaptation.md.js"></script>
  </body>
</html>
