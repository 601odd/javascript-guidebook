<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/javascript-guidebook/umi.css" />
    <script>
      window.routerBase = "/javascript-guidebook/";
    </script>
    <script>
      //! umi version: 3.2.20
    </script>
    <title>History 对象</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/javascript-guidebook-favicon.png&#x27;)" href="/javascript-guidebook//">JavaScript Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="/javascript-guidebook//basic-concept">基本语法</a><a href="/javascript-guidebook//standard-built-in-objects">内置对象</a><a href="/javascript-guidebook//core-modules">核心模块</a><a href="/javascript-guidebook//object-oriented-programming">OOP</a><a aria-current="page" class="active" href="/javascript-guidebook//browser-object-model">BOM</a><a href="/javascript-guidebook//document-object-model">DOM</a><a href="/javascript-guidebook//computer-networks">计算机网络</a><a href="/javascript-guidebook//design-patterns">设计模式</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/javascript-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/javascript-guidebook-favicon.png&#x27;)" href="/javascript-guidebook//"></a><h1>JavaScript Guidebook</h1><p>JavaScript 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/javascript-guidebook//basic-concept">基本语法</a></li><li><a href="/javascript-guidebook//standard-built-in-objects">内置对象</a></li><li><a href="/javascript-guidebook//core-modules">核心模块</a></li><li><a href="/javascript-guidebook//object-oriented-programming">OOP</a></li><li><a aria-current="page" class="active" href="/javascript-guidebook//browser-object-model">BOM</a></li><li><a href="/javascript-guidebook//document-object-model">DOM</a></li><li><a href="/javascript-guidebook//computer-networks">计算机网络</a></li><li><a href="/javascript-guidebook//design-patterns">设计模式</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/javascript-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/javascript-guidebook//browser-object-model">BOM 浏览器对象模型</a></li><li><a aria-current="page" class="active" href="/javascript-guidebook//browser-object-model/window">全局对象</a><ul><li><a href="/javascript-guidebook//browser-object-model/window/window"><span>Window 对象</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window/location"><span>Location 对象</span></a></li><li><a aria-current="page" class="active" href="/javascript-guidebook//browser-object-model/window/history"><span>History 对象</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window/screen"><span>Screen 对象</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window/navigator"><span>Navigator 对象</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/web-event">全局 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/web-event/set-interval"><span>setInterval 间歇调用</span></a></li><li><a href="/javascript-guidebook//browser-object-model/web-event/set-time-out"><span>setTimeout 超时调用</span></a></li><li><a href="/javascript-guidebook//browser-object-model/web-event/alert"><span>alert</span></a></li><li><a href="/javascript-guidebook//browser-object-model/web-event/confirm"><span>confirm</span></a></li><li><a href="/javascript-guidebook//browser-object-model/web-event/prompt"><span>prompt</span></a></li><li><a href="/javascript-guidebook//browser-object-model/web-event/drag-and-drop-api"><span>拖放 API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/web-event/request-animation-frame"><span>动画 API</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/window-position">视窗尺寸位置</a><ul><li><a href="/javascript-guidebook//browser-object-model/window-position/window-view-properties"><span>Window 对象视图属性</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window-position/screen-view-properties"><span>Screen 对象视图属性</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window-position/element-view-properties"><span>Element 文档元素视图属性</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window-position/document-view-and-element-view"><span>文档视图和元素视图</span></a></li><li><a href="/javascript-guidebook//browser-object-model/window-position/mouse-position"><span>鼠标位置</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files">二进制数据和文件 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/local-files-application"><span>本地文件应用</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/blob"><span>Blob API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/file"><span>File API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/file-list"><span>FileList API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/file-reader"><span>FileReader API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/file-reader-sync"><span>FileReaderSync API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/url"><span>URL API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/binary-data-and-files/form-data"><span>FormData API</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/connectivity">数据通信 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/connectivity/post-message"><span>PostMessage</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/xmlhttprequest"><span>XHMLHttpRequest API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/featch"><span>Fetch API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/beacon"><span>Beacon API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/web-socket"><span>WebSocket</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/event-source"><span>EventSource</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/server-sent-events"><span>Server-sent Events</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/web-real-time-communication"><span>WebRTC</span></a></li><li><a href="/javascript-guidebook//browser-object-model/connectivity/progress-event"><span>Progress Event</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage">离线与存储 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/browser-cache"><span>浏览器缓存机制</span></a></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/http-cache"><span>HTTP Cache</span></a></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/cookie"><span>Cookie</span></a></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/web-storage"><span>Web Storage</span></a></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/web-workers"><span>Web Workers</span></a></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/service-worker"><span>Service Worker</span></a></li><li><a href="/javascript-guidebook//browser-object-model/offline-and-storage/indexed-db"><span>IndexedDB</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/performance">性能 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/performance/performance"><span>Performance API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/performance/performance-resource-timing"><span>Performance Resource Timing API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/performance/performance-navigation-timing"><span>Performance Navifation API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/performance/perfromance-timeline"><span>性能时间线</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/multimedia">多媒体 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/multimedia/audio"><span>音频 Web Audio API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/multimedia/video"><span>视频 Web Video API</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/device">设备 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/device/geolocation"><span>地理定位 Geolocation API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/device/camera"><span>摄录设备</span></a></li><li><a href="/javascript-guidebook//browser-object-model/device/position"><span>位置信息 Position API</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/integration">集成 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/integration/full-screen"><span>全屏 Fullscreen API</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/observer">监视 API</a><ul><li><a href="/javascript-guidebook//browser-object-model/observer/intersection-observer"><span>IntersectionObserver API</span></a></li><li><a href="/javascript-guidebook//browser-object-model/observer/mutation-observer"><span>MutationObserver API</span></a></li></ul></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle">浏览器工作原理</a><ul><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/browser-architecture"><span>浏览器架构</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/workflow"><span>渲染进程的内部机制</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/construction-of-the-object-model"><span>构建对象模型</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/script-loading-asynchronously"><span>脚本异步加载</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/construction-of-render-tree"><span>渲染树构建</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/layout"><span>布局</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/paint"><span>绘制</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/composite"><span>合并</span></a></li><li><a href="/javascript-guidebook//browser-object-model/browser-working-principle/browser-event"><span>浏览器事件处理</span></a></li></ul></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="History 对象上的方法" data-depth="2" class=""><a href="/javascript-guidebook//browser-object-model/window/history#history-对象上的方法"><span>History 对象上的方法</span></a></li><li title="history.go()" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/window/history#historygo"><span>history.go()</span></a></li><li title="history.back()" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/window/history#historyback"><span>history.back()</span></a></li><li title="history.forward()" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/window/history#historyforward"><span>history.forward()</span></a></li><li title="history.pushState()" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/window/history#historypushstate"><span>history.pushState()</span></a></li><li title="history.replaceState()" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/window/history#historyreplacestate"><span>history.replaceState()</span></a></li><li title="window.onpopstate" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/window/history#windowonpopstate"><span>window.onpopstate</span></a></li><li title="浏览器兼容性" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/window/history#浏览器兼容性"><span>浏览器兼容性</span></a></li><li title="History 对象的属性" data-depth="2" class=""><a href="/javascript-guidebook//browser-object-model/window/history#history-对象的属性"><span>History 对象的属性</span></a></li><li title="history.length" data-depth="3" class=""><a href="/javascript-guidebook//browser-object-model/window/history#historylength"><span>history.length</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="history-对象"><a aria-hidden="true" href="#history-对象"><span class="icon icon-link"></span></a>History 对象</h1><h2 id="history-对象上的方法"><a aria-hidden="true" href="#history-对象上的方法"><span class="icon icon-link"></span></a>History 对象上的方法</h2><h3 id="historygo"><a aria-hidden="true" href="#historygo"><span class="icon icon-link"></span></a>history.go()</h3><p>使用  <code>history.go()</code>  方法可以在用户的历史记录中任意跳转，可以向后也可以向前。这个方法接受一个参数，表示向后或向前跳转的页面数的一个整数值。负数表示向后跳转（类似于单击浏览器的“后退”按钮），正数表示向前跳转（类似于单击浏览器的“前进”按钮）。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// 后退一页
history.go(-1);

// 前进一页
history.go(1);

// 前进两页
history.go(2);
" data-status="copy"></button><div class="token-line"><span class="token comment">// 后退一页</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token method function property-access">go</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 前进一页</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token method function property-access">go</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 前进两页</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token method function property-access">go</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>也可以给  <code>go()</code>  方法传递一个字符串参数，此时浏览器会跳转到历史记录中包含该字符串的第一个位置——可能后退，也可能前进，具体要看哪个位置最近。如果历史记录中不包含该字符串，那么这个方法什么也不做。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// 跳转到最近的 github.com 页面
history.go(&#x27;github.com&#x27;);
" data-status="copy"></button><div class="token-line"><span class="token comment">// 跳转到最近的 github.com 页面</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token method function property-access">go</span><span class="token punctuation">(</span><span class="token string">&#x27;github.com&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>当<code>history.go()</code> 方法无参数时，相当于 <code>history.go(0)</code>，可以刷新当前页面</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// 刷新当前页面
history.go();

// 刷新当前页面
history.go(0);
" data-status="copy"></button><div class="token-line"><span class="token comment">// 刷新当前页面</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token method function property-access">go</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 刷新当前页面</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token method function property-access">go</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="historyback"><a aria-hidden="true" href="#historyback"><span class="icon icon-link"></span></a>history.back()</h3><p><code>history.back()</code> 方法用于模仿浏览器的后退按钮，相当于 <code>history.go(-1)</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// 下面两种写法效果一致
history.back();
history.go(-1);
" data-status="copy"></button><div class="token-line"><span class="token comment">// 下面两种写法效果一致</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token method function property-access">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token method function property-access">go</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="historyforward"><a aria-hidden="true" href="#historyforward"><span class="icon icon-link"></span></a>history.forward()</h3><p><code>forward()</code> 方法用于模仿浏览器的前进按钮，相当于 <code>history.go(1)</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// 后退一页
history.back();
// 前进一页
history.forward();
" data-status="copy"></button><div class="token-line"><span class="token comment">// 后退一页</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token method function property-access">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 前进一页</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token method function property-access">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>如果移动的位置超出了访问历史的边界，以上三个方法并不报错，而是静默失败 。</p><p>使用历史记录时，页面通常从浏览器缓存之中加载，而不是重新要求服务器发送新的网页。</p><h3 id="historypushstate"><a aria-hidden="true" href="#historypushstate"><span class="icon icon-link"></span></a>history.pushState()</h3><p>向当前浏览记录栈中添加一条新的历史记录，添加后页面不会重新加载。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="history.pushState(state, title, url);
" data-status="copy"></button><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token method function property-access">pushState</span><span class="token punctuation">(</span><span class="token plain">state</span><span class="token punctuation">,</span><span class="token plain"> title</span><span class="token punctuation">,</span><span class="token plain"> url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><ul><li>state：<strong>用于存储该 URL 对应的状态对象</strong>。该对象可通过 <code>history.state</code> 或 <code>popstate</code> 事件回调中的 event 对象获取。如果不需要这个对象，此处可以填 null。</li><li>title：<strong>新页面的标题</strong>，但是所有浏览器目前都忽略这个值，因此这里可以填 null。</li><li>url：<strong>URL 地址</strong>，不允许跨域。这个参数可选，如果它没有被特别标注，会被设置为文档的当前 URL。</li></ul><p><code>history.pushState</code> 函数向浏览器的历史堆栈压入一个 url 为设定值的记录，并改变历史堆栈的当前指针至栈顶。</p><p>调用 <code>pushState()</code> 方法将新生成一条历史记录，方便用浏览器的“后退”和“前进”来导航（“后退”可是相当常用的按钮）。另外，从 URL 的同源策略可以看出，HTML5 history API 的出发点是很明确的，就是让无跳转的单站点也可以将它的各个状态保存为浏览器的多条历史记录。当通过历史记录重新加载站点时，站点可以直接加载到对应的状态。</p><p>将 <code>url</code> 设为锚点值时不会触发 <code>onhashchange</code></p><p>根据<strong>同源策略</strong>，如果设置不同域名地址，会报错，这样做的目的是：防止用户以为它们是同一个网站，若没有此限制，将很容易进行 <code>XSS</code> 、 <code>CSRF</code> 等攻击方式</p><h3 id="historyreplacestate"><a aria-hidden="true" href="#historyreplacestate"><span class="icon icon-link"></span></a>history.replaceState()</h3><p>它和 <code>history.pushState()</code> 方法基本相同，区别只有一点，<strong><code>history.replaceState()</code> 不会新生成历史记录，而是将当前历史记录替换掉，常用于落地页</strong>。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="history.replaceState(state, title, url);
" data-status="copy"></button><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token method function property-access">replaceState</span><span class="token punctuation">(</span><span class="token plain">state</span><span class="token punctuation">,</span><span class="token plain"> title</span><span class="token punctuation">,</span><span class="token plain"> url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="windowonpopstate"><a aria-hidden="true" href="#windowonpopstate"><span class="icon icon-link"></span></a>window.onpopstate</h3><p>push 的对立就是 pop，可以猜到这个事件是在浏览器取出历史记录并加载时触发的。但实际上，它的条件是比较苛刻的，几乎只有<strong>点击浏览器的“前进”、“后退”这些导航按钮，或者是由 JavaScript 调用的 <code>history.back()</code> 等导航方法</strong>，且<strong>切换前后的两条历史记录都属于同一个网页文档</strong>，才会触发本事件，因为这些操作有一个共性，即修改了历史堆栈的当前指针。</p><p>上面的“同一个网页文档”请理解为 JavaScript 环境的 <code>document</code> 是同一个，而不是指基础 URL（去掉各类参数的）相同。也就是说，只要有重新加载发生（无论是跳转到一个新站点还是继续在本站点），JavaScript 全局环境发生了变化，<code>popstate</code> 事件都不会触发。</p><p><code>popstate</code> 事件是设计出来和前面的 2 个方法搭配使用的。一般只有在通过前面 2 个方法设置了同一站点的多条历史记录，并在其之间导航（前进或后退）时，才会触发这个事件。同时，前面 2 个方法所设置的状态对象（第 1 个参数），也会在这个时候通过事件的 <code>event.state</code> 返还回来。</p><p>此外请注意，<code>history.pushState()</code> 及 <code>history.replaceState()</code> 本身调用时是不触发 <code>popstate</code> 事件的。pop 和 push 毕竟不一样！</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="window.onpopstate = function(event) {
  alert(&#x27;location: &#x27; + document.location + &#x27;, state: &#x27; + JSON.stringify(event.state));
};
" data-status="copy"></button><div class="token-line"><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">onpopstate</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#x27;location: &#x27;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">location</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string">&#x27;, state: &#x27;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token plain">event</span><span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="浏览器兼容性"><a aria-hidden="true" href="#浏览器兼容性"><span class="icon icon-link"></span></a>浏览器兼容性</h3><table><thead><tr><th>Feature</th><th>Chrome</th><th>Firefox（Gecko）</th><th>Internet Explorer</th><th>Opera</th><th>Safari</th></tr></thead><tbody><tr><td>replaceState.pushState</td><td>5</td><td>4.0（2.0）</td><td>10</td><td>11.50</td><td>5.0</td></tr><tr><td>history.state</td><td>18</td><td>4.0（2.0）</td><td>10</td><td>11.50</td><td>6.0</td></tr></tbody></table><hr/><p>资料参考（深入了解）：</p><ul><li><a href="https://github.com/ShowJoy-com/showjoy-blog/issues/2" target="_blank" rel="noopener noreferrer">「前端」History API 与浏览器历史堆栈管理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h2 id="history-对象的属性"><a aria-hidden="true" href="#history-对象的属性"><span class="icon icon-link"></span></a>History 对象的属性</h2><p><code>history</code> 对象保存着用户上网的历史记录，从窗口被打开的那一刻算起。因为 <code>history</code> 是 <code>window</code> 对象的属性，因此每个浏览器窗口、每个标签页乃至每个框架，都有自己的 <code>history</code> 对象与特定的 <code>window</code> 对象关联。出于安全方面的考虑，开发人员无法得知用户浏览过的 URL。不过，借由用户访问过的页面列表，同样可以在不知道实际 URL 的情况下实现后退和前进。</p><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td>length</td><td>返回一个整数，该整数表示会话历史中元素的数目，包括当前加载的页。</td></tr><tr><td>scrollRestoration</td><td>允许 Web 应用程序在历史导航上显式地设置默认滚动恢复行为。</td></tr><tr><td>state</td><td>返回一个表示历史栈堆顶部状态的值。这是一种可以不必等待 popstate 事件而查看状态的方式。</td></tr></tbody></table><h3 id="historylength"><a aria-hidden="true" href="#historylength"><span class="icon icon-link"></span></a>history.length</h3><p><code>history.length</code> 属性保存着历史记录的 URL 数量。初始时，该值为 1。如果当前窗口先后访问了三个网址，<code>history.length</code> 属性等于 3。</p><p>由于 IE10+浏览器在初始时返回 2，存在兼容性问题，所以该值并不常用</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="history.length; // 初始时，该值为1
history.length; // 访问三个网址后，该值为3
" data-status="copy"></button><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// 初始时，该值为1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">history</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">;</span><span class="token plain"> </span><span class="token comment">// 访问三个网址后，该值为3</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/javascript-guidebook/edit/master/docs/browser-object-model/window/history.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last Update: ">9/19/2020, 10:25:22 AM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/javascript-guidebook/umi.js"></script>
    <script src="/javascript-guidebook/docs__browser-object-model__window__history.md.js"></script>
  </body>
</html>
